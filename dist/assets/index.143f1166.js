import{c as D,n as B,t as $,d as W,u as be,ax as X,a1 as Q,a as u,aj as N,w as j,ay as _e,a8 as xe,az as pe,aA as ye,al as we,X as P,m as ke,e as Se,ab as Ce,r as Ie,E as R,f as Ve,g as I,b as Ee,ac as Te,V as ze,G as Pe,a5 as z,W as Be,$ as L,aB as Me,I as F,aC as Ae,aD as K,i as Z,aq as Re,aE as Le,a7 as Fe,F as Oe}from"./index.178e022e.js";import{c as $e,C as Ne}from"./index.1887c1b8.js";import{u as De}from"./use-id.f85502fd.js";const[We,je]=D("form"),qe={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:B,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:$,showErrorMessage:$,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Ge=W({name:We,props:qe,emits:["submit","failed"],setup(e,{emit:a,slots:i}){const{children:s,linkChildren:l}=be(X),d=n=>n?s.filter(c=>n.includes(c.name)):s,V=n=>new Promise((c,v)=>{const b=[];d(n).reduce((C,A)=>C.then(()=>{if(!b.length)return A.validate().then(w=>{w&&b.push(w)})}),Promise.resolve()).then(()=>{b.length?v(b):c()})}),k=n=>new Promise((c,v)=>{const b=d(n);Promise.all(b.map(_=>_.validate())).then(_=>{_=_.filter(Boolean),_.length?v(_):c()})}),m=n=>{const c=s.find(v=>v.name===n);return c?new Promise((v,b)=>{c.validate().then(_=>{_?b(_):v()})}):Promise.reject()},p=n=>typeof n=="string"?m(n):e.validateFirst?V(n):k(n),h=n=>{typeof n=="string"&&(n=[n]),d(n).forEach(v=>{v.resetValidation()})},M=()=>s.reduce((n,c)=>(n[c.name]=c.getValidationStatus(),n),{}),S=(n,c)=>{s.some(v=>v.name===n?(v.$el.scrollIntoView(c),!0):!1)},E=()=>s.reduce((n,c)=>(n[c.name]=c.formValue.value,n),{}),y=()=>{const n=E();p().then(()=>a("submit",n)).catch(c=>{a("failed",{values:n,errors:c}),e.scrollToError&&c[0].name&&S(c[0].name)})},T=n=>{N(n),y()};return l({props:e}),Q({submit:y,validate:p,getValues:E,scrollToField:S,resetValidation:h,getValidationStatus:M}),()=>{var n;return u("form",{class:je(),onSubmit:T},[(n=i.default)==null?void 0:n.call(i)])}}});const ct=j(Ge);function ee(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function He(e,a){if(ee(e)){if(a.required)return!1;if(a.validateEmpty===!1)return!0}return!(a.pattern&&!a.pattern.test(String(e)))}function Ke(e,a){return new Promise(i=>{const s=a.validator(e,a);if(pe(s)){s.then(i);return}i(s)})}function U(e,a){const{message:i}=a;return ye(i)?i(e,a):i||""}function Ue({target:e}){e.composing=!0}function Y({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Ye(e,a){const i=_e();e.style.height="auto";let s=e.scrollHeight;if(we(a)){const{maxHeight:l,minHeight:d}=a;l!==void 0&&(s=Math.min(s,l)),d!==void 0&&(s=Math.max(s,d))}s&&(e.style.height=`${s}px`,xe(i))}function Je(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function O(e){return[...e].length}function Xe(e,a){return[...e].slice(0,a).join("")}const[Qe,x]=D("field"),Ze={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:B,formatter:Function,clearIcon:P("clear"),modelValue:ke(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:P("focus"),formatTrigger:P("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},et=Se({},$e,Ze,{rows:B,type:P("text"),rules:Array,autosize:[Boolean,Object],labelWidth:B,labelClass:Ce,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var tt=W({name:Qe,props:et,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:a,slots:i}){const s=De(),l=Ie({status:"unvalidated",focused:!1,validateMessage:""}),d=R(),V=R(),k=R(),{parent:m}=Ve(X),p=()=>{var t;return String((t=e.modelValue)!=null?t:"")},h=t=>{if(L(e[t]))return e[t];if(m&&L(m.props[t]))return m.props[t]},M=I(()=>{const t=h("readonly");if(e.clearable&&!t){const r=p()!=="",o=e.clearTrigger==="always"||e.clearTrigger==="focus"&&l.focused;return r&&o}return!1}),S=I(()=>k.value&&i.input?k.value():e.modelValue),E=t=>t.reduce((r,o)=>r.then(()=>{if(l.status==="failed")return;let{value:g}=S;if(o.formatter&&(g=o.formatter(g,o)),!He(g,o)){l.status="failed",l.validateMessage=U(g,o);return}if(o.validator)return ee(g)&&o.validateEmpty===!1?void 0:Ke(g,o).then(f=>{f&&typeof f=="string"?(l.status="failed",l.validateMessage=f):f===!1&&(l.status="failed",l.validateMessage=U(g,o))})}),Promise.resolve()),y=()=>{l.status="unvalidated",l.validateMessage=""},T=()=>a("endValidate",{status:l.status,message:l.validateMessage}),n=(t=e.rules)=>new Promise(r=>{y(),t?(a("startValidate"),E(t).then(()=>{l.status==="failed"?(r({name:e.name,message:l.validateMessage}),T()):(l.status="passed",r(),T())})):r()}),c=t=>{if(m&&e.rules){const{validateTrigger:r}=m.props,o=K(r).includes(t),g=e.rules.filter(f=>f.trigger?K(f.trigger).includes(t):o);g.length&&n(g)}},v=t=>{const{maxlength:r}=e;if(L(r)&&O(t)>r){const o=p();return o&&O(o)===+r?o:Xe(t,+r)}return t},b=(t,r="onChange")=>{const o=t;t=v(t);const g=t!==o;if(e.type==="number"||e.type==="digit"){const f=e.type==="number";t=Me(t,f,f)}if(e.formatter&&r===e.formatTrigger&&(t=e.formatter(t)),d.value&&d.value.value!==t)if(l.focused&&g){const{selectionStart:f,selectionEnd:he}=d.value;d.value.value=t,d.value.setSelectionRange(f-1,he-1)}else d.value.value=t;t!==e.modelValue&&a("update:modelValue",t)},_=t=>{t.target.composing||b(t.target.value)},C=()=>{var t;return(t=d.value)==null?void 0:t.blur()},A=()=>{var t;return(t=d.value)==null?void 0:t.focus()},w=()=>{const t=d.value;e.type==="textarea"&&e.autosize&&t&&Ye(t,e.autosize)},te=t=>{l.focused=!0,a("focus",t),z(w),h("readonly")&&C()},ne=t=>{h("readonly")||(l.focused=!1,b(p(),"onBlur"),a("blur",t),c("onBlur"),z(w),Le())},q=t=>a("clickInput",t),ae=t=>a("clickLeftIcon",t),re=t=>a("clickRightIcon",t),le=t=>{N(t),a("update:modelValue",""),a("clear",t)},G=I(()=>{if(typeof e.error=="boolean")return e.error;if(m&&m.props.showError&&l.status==="failed")return!0}),ie=I(()=>{const t=h("labelWidth");if(t)return{width:Ee(t)}}),oe=t=>{t.keyCode===13&&(!(m&&m.props.submitOnEnter)&&e.type!=="textarea"&&N(t),e.type==="search"&&C()),a("keypress",t)},H=()=>e.id||`${s}-input`,ce=()=>l.status,se=()=>{const t=x("control",[h("inputAlign"),{error:G.value,custom:!!i.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(i.input)return u("div",{class:t,onClick:q},[i.input()]);const r={id:H(),ref:d,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:h("disabled"),readonly:h("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${s}-label`:void 0,onBlur:ne,onFocus:te,onInput:_,onClick:q,onChange:Y,onKeypress:oe,onCompositionend:Y,onCompositionstart:Ue};return e.type==="textarea"?u("textarea",r,null):u("input",Z(Je(e.type),r),null)},de=()=>{const t=i["left-icon"];if(e.leftIcon||t)return u("div",{class:x("left-icon"),onClick:ae},[t?t():u(F,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},ue=()=>{const t=i["right-icon"];if(e.rightIcon||t)return u("div",{class:x("right-icon"),onClick:re},[t?t():u(F,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},fe=()=>{if(e.showWordLimit&&e.maxlength){const t=O(p());return u("div",{class:x("word-limit")},[u("span",{class:x("word-num")},[t]),Re("/"),e.maxlength])}},ve=()=>{if(m&&m.props.showErrorMessage===!1)return;const t=e.errorMessage||l.validateMessage;if(t){const r=i["error-message"],o=h("errorMessageAlign");return u("div",{class:x("error-message",o)},[r?r({message:t}):t])}},ge=()=>{const t=h("colon")?":":"";if(i.label)return[i.label(),t];if(e.label)return u("label",{id:`${s}-label`,for:H()},[e.label+t])},me=()=>[u("div",{class:x("body")},[se(),M.value&&u(F,{ref:V,name:e.clearIcon,class:x("clear")},null),ue(),i.button&&u("div",{class:x("button")},[i.button()])]),fe(),ve()];return Q({blur:C,focus:A,validate:n,formValue:S,resetValidation:y,getValidationStatus:ce}),Te(Ae,{customValue:k,resetValidation:y,validateWithTrigger:c}),ze(()=>e.modelValue,()=>{b(p()),y(),c("onChange"),z(w)}),Pe(()=>{b(p(),e.formatTrigger),z(w)}),Be("touchstart",le,{target:I(()=>{var t;return(t=V.value)==null?void 0:t.$el})}),()=>{const t=h("disabled"),r=h("labelAlign"),o=de(),g=()=>{const f=ge();return r==="top"?[o,f].filter(Boolean):f||[]};return u(Ne,{size:e.size,class:x({error:G.value,disabled:t,[`label-${r}`]:r}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:ie.value,valueClass:x("value"),titleClass:[x("label",[r,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:o&&r!=="top"?()=>o:null,title:g,value:me,extra:i.extra})}}});const st=j(tt),[nt,J]=D("cell-group"),at={title:String,inset:Boolean,border:$};var rt=W({name:nt,inheritAttrs:!1,props:at,setup(e,{slots:a,attrs:i}){const s=()=>{var d;return u("div",Z({class:[J({inset:e.inset}),{[Fe]:e.border&&!e.inset}]},i),[(d=a.default)==null?void 0:d.call(a)])},l=()=>u("div",{class:J("title",{inset:e.inset})},[a.title?a.title():e.title]);return()=>e.title||a.title?u(Oe,null,[l(),s()]):s()}});const dt=j(rt);export{dt as C,st as F,ct as a};
