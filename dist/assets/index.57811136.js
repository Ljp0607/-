import{r as F}from"./request.d81ce039.js";import{b as et,s as k,g as j,a as at}from"./wx-share.7f07638e.js";import{_ as H,d as G,e as K,u as Q,o as s,c,a as t,n as ot,F as C,r as B,t as g,m as T,v as L,h as w,w as x,p as X,b as Y,q as nt,T as v,D as it,C as rt,B as dt,O as st,s as ct,f as M,g as lt,x as ut,P as vt,j as gt,k as ht,y as q,l as J,i as pt}from"./index.4cfa603b.js";import{F as wt,a as bt,c as ft,s as mt}from"./index.571fde4d.js";const _t=n=>F.get("app/daheDrawActivityConfig/findDrawActivityConfigByAactivityNo",n,""),xt=n=>F.get("app/daheDrawActivityConfig/drawRecordList",n,""),yt=n=>F.get("app/daheDrawActivityConfig/getUserCodeAndinvitationList",n,""),kt=n=>F.get("app/daheDrawActivityConfig/toDraw",n,""),Ct=n=>F.get("app/daheDrawActivityConfig/findDrawCount",n,""),At=(n,y)=>F.post("app/daheDrawActivityConfig/saveAddress"+n,y,"");var A={findDraw:_t,drawRecordList:xt,getUserCode:yt,toDraw:kt,findDrawCount:Ct,saveAddress:At};const $=n=>(X("data-v-68b2c5fc"),n=n(),Y(),n),Ft={class:"wrapper"},zt={class:"sector-inner"},Bt=["src"],$t=$(()=>t("div",{class:"start"},"\u7ACB\u5373\u62BD\u5956",-1)),Dt=[$t],Nt={class:"van-overlay"},It={class:"block"},Et=$(()=>t("div",null,"\u8BF7\u586B\u5199\u9886\u5956\u4FE1\u606F",-1)),Tt={style:{margin:"16px"}},Lt=nt(" \u63D0\u4EA4 "),Rt={class:"number"},St={class:"residue"},Wt=$(()=>t("text",null," \u60A8\u5F53\u524D\u5269\u4F59 ",-1)),Vt={style:{color:"#fc0404"}},Ut=$(()=>t("text",null," \u62BD\u5956\u673A\u4F1A ",-1)),Pt=$(()=>t("div",{class:"assistance"},"\u53C2\u52A0\u6295\u7A3F\u53EF\u83B71\u6B21\u62BD\u5956\u673A\u4F1A",-1)),Ot=G({__name:"Corona",props:{RecordList:Function,activityRule:Function},setup(n){const y=n,e=K({number:0,message:{realName:"",phone:"",address:""},show:!1,rotateAngle:0,time:0,IsTurnOver:!0,rotate_angle:"",activity:{poolList:[]}}),a=Q(),b=/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[1589]))\d{8}$/;A.findDraw({userId:a.$state.userId,activityNo:a.$state.activityNo}).then(l=>{y.activityRule(l.drawActivityConfig.activityRule),e.activity=l.drawActivityConfig});function d(){A.saveAddress(`?userId=${a.$state.userId}&activityNo=${a.$state.activityNo}`,JSON.stringify({realName:e.message.realName,recordNo:e.message.recordNo,phone:e.message.phone,activityNo:a.$state.activityNo,address:e.message.address})).then(l=>{v(l.message),e.show=!1,y.RecordList()})}function D(){A.findDrawCount({userId:a.$state.userId,activityNo:a.$state.activityNo}).then(l=>{l.drawCount>=0&&(e.number=l.drawCount)})}function f(){e.IsTurnOver?e.number==0?v("\u6682\u65E0\u62BD\u5956\u6B21\u6570"):(e.IsTurnOver=!1,A.toDraw({userId:a.$state.userId,activityNo:a.$state.activityNo}).then(l=>{D(),e.activity.poolList.map((u,m)=>{if(u.awardNo==l.awardNo){e.message.recordNo=l.recordNo,N(m+1),setTimeout(function(){u.awardFlag=="1"?it.alert({message:"\u606D\u559C\u83B7\u5F97"+u.awardName}).then(()=>{e.show=!0}):v(u.awardName),e.IsTurnOver=!0},5200);return}})})):v("\u8BF7\u52FF\u91CD\u590D\u62BD\u5956")}function N(l){switch(e.rotateAngle=e.rotateAngle-e.time,l){case 1:e.time=Math.random()*(30-0)+0;break;case 6:e.time=Math.random()*(85-35)+35;break;case 5:e.time=Math.random()*(145-95)+95;break;case 4:e.time=Math.random()*(205-155)+155;break;case 3:e.time=Math.random()*(265-215)+215;break;case 2:e.time=Math.random()*(325-275)+275;break}e.rotateAngle=e.rotateAngle+3600+e.time,e.rotate_angle=`rotate(${e.rotateAngle}deg)`}function S(l){d()}return D(),(l,u)=>{const m=wt,W=rt,I=dt,E=bt,V=st;return s(),c(C,null,[t("div",Ft,[t("div",{class:"panel",style:ot({transform:e.rotate_angle,transition:"5s"})},[(s(!0),c(C,null,B(e.activity.poolList,(h,U)=>(s(),c("div",{class:"sector",key:U},[t("div",zt,[t("span",null,g(h.awardName),1),T(t("img",{src:h.awardImage},null,8,Bt),[[L,h.awardImage]])])]))),128))],4),t("div",{class:"pointer",onClick:f},Dt),w(V,{show:e.show},{default:x(()=>[t("div",Nt,[t("div",It,[Et,w(E,{onSubmit:S},{default:x(()=>[w(W,{inset:""},{default:x(()=>[w(m,{modelValue:e.message.realName,"onUpdate:modelValue":u[0]||(u[0]=h=>e.message.realName=h),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",name:"realName",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D"}]},null,8,["modelValue"]),w(m,{modelValue:e.message.phone,"onUpdate:modelValue":u[1]||(u[1]=h=>e.message.phone=h),placeholder:"\u8BF7\u8F93\u5165\u7535\u8BDD\u53F7\u7801",name:"phone",rules:[{pattern:b,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u624B\u673A\u53F7"}]},null,8,["modelValue","rules"]),w(m,{modelValue:e.message.address,"onUpdate:modelValue":u[2]||(u[2]=h=>e.message.address=h),placeholder:"\u8BF7\u8F93\u5165\u5730\u5740",name:"address",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5730\u5740"}]},null,8,["modelValue"])]),_:1}),t("div",Tt,[w(I,{round:"",block:"",type:"primary","native-type":"submit"},{default:x(()=>[Lt]),_:1})])]),_:1})])])]),_:1},8,["show"])]),t("div",Rt,[t("div",St,[Wt,t("text",Vt,g(e.number)+"\u6B21 ",1),Ut]),Pt])],64)}}});var jt=H(Ot,[["__scopeId","data-v-68b2c5fc"]]);const R=n=>(X("data-v-69253edc"),n=n(),Y(),n),Mt={class:"content"},qt={class:"tab"},Jt={class:"tab_content"},Ht={class:"item_content"},Gt=["onClick"],Kt=["src"],Qt=R(()=>t("img",{class:"item_start",src:"https://imgcdn.dahebao.cn/20221011/20221011094515515822.png"},null,-1)),Xt=["onClick"],Yt=["src"],Zt={class:"postsTitle"},te={class:"hotData"},ee=R(()=>t("span",null," \u4EBA\u6C14\u503C:",-1)),ae={style:{color:"#dc5d3c"}},oe=["onClick"],ne=["onClick"],ie={key:0,class:"empty",src:"https://imgcdn.dahebao.cn/20221027/20221027113957273185.png",alt:""},re={class:"button"},de=R(()=>t("div",{class:"title"},"\u6295\u7A3F\u5373\u53EF\u53C2\u4E0E\u62BD\u5956",-1)),se={class:"lottery"},ce={key:0,class:"recordWeek"},le=R(()=>t("div",{class:"title"},"\u5468\u8BC4\u699C\uFF1A\u9AD8\u4EBA\u6C14\u4F5C\u54C1\u7528\u6237",-1)),ue={class:"groud"},ve={class:"record"},ge=G({__name:"index",setup(n){const y=ct(),e=M(0),a=K({show:!1,item:[],recordList:[],recordListWeek:[],city:[],currentPage:1,activityRule:""}),b=M(),d=Q();function D(){ft().then(i=>{i.map(o=>{delete o.children}),a.city=i,d.$state.citys=i}).then(()=>{J.get("https://restapi.amap.com/v3/ip?key=8f97aea18038bcb28d2d29b1c5cf5158").then(i=>{i.status==1?a.city.map((o,z)=>{i.adcode==o.city_id&&(e.value=z,d.changeCity(o))}):d.changeCity(a.city[0])}).then(()=>{f(!1),e.value==0&&d.changeCity(a.city[0])}).catch(()=>{d.changeCity(a.city[0]),f(!1)})})}function f(i){mt(d.$state.userId,a.city[e.value].city_id,a.currentPage).then(o=>{o.state==1?(o.data.length==0&&i?(v("\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86"),--a.currentPage):a.item=o.data,o.data.length<4?a.city[e.value].more="no-more":a.city[e.value].more="more"):v(o.message)})}function N(){A.drawRecordList({userId:d.$state.userId,activityNo:d.$state.activityNo,awardFlag:"1",page_index:0,page_count:200}).then(i=>{a.recordList=i.recordList})}function S(){A.drawRecordList({userId:d.$state.userId,activityNo:"b2101db8b4e54358a042ba9306049791",awardFlag:"1",page_index:0,page_count:200}).then(i=>{a.recordListWeek=i.recordList})}function l(){a.city[e.value].more=="no-more"?v("\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86"):(++a.currentPage,f(!0))}function u(){if(a.currentPage<=1){v("\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86");return}else--a.currentPage,f(!0)}function m(){a.currentPage=1,f(!1)}function W(){d.$state.userId==""&&k()?(v("\u8BF7\u5728\u8C6B\u89C6\u9891App\u4E0A\u4F20\u65B0\u5730\u6807"),setTimeout(()=>{location.href="https://news.dahebao.cn/appdownload/index.html?Type=102&openUrl=https://news.dahebao.cn/dahe/h5/cityvote/index.html#/autoShow"},500)):d.$state.userId==""&&!k()?j():y.push({name:"uploading"})}function I(i){d.$state.userId==""&&k()?(v("\u8BF7\u5728\u8C6B\u89C6\u9891App\u67E5\u770B\u8BE6\u60C5"),setTimeout(()=>{location.href="https://news.dahebao.cn/appdownload/index.html?Type=102&openUrl=https://news.dahebao.cn/dahe/h5/cityvote/index.html#/autoShow"},500)):d.$state.userId==""&&!k()?j():at(i.postsId)}function E(i,o){d.$state.userId==""&&k()?(v("\u8BF7\u5728\u8C6B\u89C6\u9891App\u6295\u7968"),setTimeout(()=>{location.href="https://news.dahebao.cn/appdownload/index.html?Type=102&openUrl=https://news.dahebao.cn/dahe/h5/cityvote/index.html#/autoShow"},500)):d.$state.userId==""&&!k()?j():V(i,o)}function V(i,o){a.item[o].ifThumb==0?J({method:"get",url:"https://news.dahebao.cn/dahe/appposts/poststhumbup",params:{data:JSON.stringify({user_id:d.$state.userId,action_type:1,posts_id:i.postsId}),headers:{"Content-Type":"application/json"}}}).then(z=>{z.state==1&&(a.item[o].hotData+=10,a.item[o].ifThumb=1,v("\u6295\u7968\u6210\u529F"))}):v("\u6BCF\u4E2A\u4F5C\u54C1\u53EA\u80FD\u6295\u4E00\u7968\u54E6")}function h(i){a.activityRule=i}let U=setInterval(()=>{b.value.scrollTop>=b.value.scrollHeight-b.value.clientHeight?b.value.scrollTop=0:b.value.scrollTop+=.5},100);return et({type:22,share_url:window.location.href},"\u6CB3\u5357\u65B0\u5730\u6807","2022\u6CB3\u5357\u65B0\u5730\u6807,\u7ED9\u4F60\u5FC3\u91CC\u7684\u5730\u65B9\u6295\u7968!"),lt(()=>{D(),N(),S()}),ut(()=>{clearInterval(U)}),(i,o)=>{const z=vt,Z=gt,tt=ht;return s(),c("div",Mt,[t("header",null,[t("div",{class:"title",onClick:o[0]||(o[0]=r=>a.show=!0)},"\u6D3B\u52A8\u89C4\u5219"),t("img",{onClick:W,src:"https://imgcdn.dahebao.cn/20221206/20221206150922616976.png"})]),w(z,{class:"van-popup",show:a.show,"onUpdate:show":o[1]||(o[1]=r=>a.show=r),onClick:o[2]||(o[2]=r=>a.show=!1)},{default:x(()=>[t("span",null,g(a.activityRule),1)]),_:1},8,["show"]),t("main",qt,[w(tt,{active:e.value,"onUpdate:active":o[3]||(o[3]=r=>e.value=r),onChange:m,animated:!1,swipeable:""},{default:x(()=>[(s(!0),c(C,null,B(a.city,(r,_)=>(s(),pt(Z,{title:r.city_name,key:_},{default:x(()=>[t("div",Jt,[t("div",Ht,[(s(!0),c(C,null,B(a.item,(p,P)=>(s(),c("div",{class:"item",key:P},[p.postsVideo?(s(),c("div",{key:0,onClick:O=>I(p),class:"video"},[t("img",{src:p.postsVideoImg},null,8,Kt),Qt],8,Gt)):(s(),c("div",{key:1,onClick:O=>I(p),class:"img"},[t("img",{class:"postsImg",src:JSON.parse(p.postsImg)[0].imgUrl+"/pc_600"},null,8,Yt)],8,Xt)),t("div",Zt,[t("div",te,[ee,t("span",ae,g(p.hotData),1)]),t("span",null,g(p.postsTitle),1)]),p.ifThumb?(s(),c("div",{key:3,class:"text",onClick:O=>E(p,P)}," \u5DF2\u6295\u7968 ",8,ne)):(s(),c("div",{key:2,class:"text",onClick:O=>E(p,P)}," \u4E3ATA\u6295\u7968 ",8,oe))]))),128)),a.item.length==0?(s(),c("img",ie)):q("",!0)]),T(t("div",re,[t("button",{onClick:u},"\u4E0A\u4E00\u9875"),t("button",{onClick:l},"\u4E0B\u4E00\u9875")],512),[[L,a.item.length!=0]])])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),t("footer",null,[de,t("div",se,[w(jt,{RecordList:N,activityRule:h})])]),a.recordListWeek.length>0?(s(),c("div",ce,[le,t("div",ue,[(s(!0),c(C,null,B(a.recordListWeek,(r,_)=>T((s(),c("div",{class:"cell",key:_},[t("div",null,g(_<3?"":_+1),1),t("div",null,g(r.realName),1),t("div",null,g(r.awardName),1),t("div",null,g(r.phone),1)])),[[L,r.realName&&r.awardName&&r.phone]])),128))])])):q("",!0),t("div",ve,[t("div",{class:"groud",ref_key:"scrollRef",ref:b},[(s(!0),c(C,null,B(a.recordList,(r,_)=>T((s(),c("div",{class:"cell",key:_},[t("div",null,g(r.realName),1),t("div",null,g(r.awardName),1),t("div",null,g(r.phone),1)])),[[L,r.realName&&r.awardName&&r.phone]])),128))],512)])])}}});var fe=H(ge,[["__scopeId","data-v-69253edc"]]);export{fe as default};
