import{c as G,t as C,n as V,m as O,d as K,E as L,r as U,ag as le,u as ve,g as d,a1 as Z,V as k,a2 as ue,ah as de,ai as fe,G as q,a3 as he,a4 as we,O as ge,P as me,W as pe,a as T,Y as j,a5 as F,af as $,aj as be,ak as D,w as J,f as ye}from"./index.4a3d8a83.js";const[Q,A]=G("swipe"),_e={loop:C,width:V,height:V,vertical:Boolean,autoplay:O(0),duration:O(500),touchable:C,lazyRender:Boolean,initialSwipe:O(0),indicatorColor:String,showIndicators:C,stopPropagation:C},ee=Symbol(Q);var xe=K({name:Q,props:_e,emits:["change"],setup(a,{emit:S,slots:h}){const l=L(),f=L(),e=U({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),v=le(),{children:w,linkChildren:E}=ve(ee),i=d(()=>w.length),c=d(()=>e[a.vertical?"height":"width"]),s=d(()=>a.vertical?v.deltaY.value:v.deltaX.value),g=d(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-c.value*i.value:0),I=d(()=>c.value?Math.ceil(Math.abs(g.value)/c.value):i.value),b=d(()=>i.value*c.value),z=d(()=>(e.active+i.value)%i.value),Y=d(()=>{const t=a.vertical?"vertical":"horizontal";return v.direction.value===t}),te=d(()=>{const t={transitionDuration:`${e.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${e.offset}px)`};if(c.value){const o=a.vertical?"height":"width",n=a.vertical?"width":"height";t[o]=`${b.value}px`,t[n]=a[n]?`${a[n]}px`:""}return t}),ae=t=>{const{active:o}=e;return t?a.loop?D(o+t,-1,i.value):D(o+t,0,I.value):o},R=(t,o=0)=>{let n=t*c.value;a.loop||(n=Math.min(n,-g.value));let u=o-n;return a.loop||(u=D(u,g.value,0)),u},m=({pace:t=0,offset:o=0,emitChange:n})=>{if(i.value<=1)return;const{active:u}=e,r=ae(t),x=R(r,o);if(a.loop){if(w[0]&&x!==g.value){const M=x<g.value;w[0].setOffset(M?b.value:0)}if(w[i.value-1]&&x!==0){const M=x>0;w[i.value-1].setOffset(M?-b.value:0)}}e.active=r,e.offset=x,n&&r!==u&&S("change",z.value)},P=()=>{e.swiping=!0,e.active<=-1?m({pace:i.value}):e.active>=i.value&&m({pace:-i.value})},ie=()=>{P(),v.reset(),$(()=>{e.swiping=!1,m({pace:-1,emitChange:!0})})},B=()=>{P(),v.reset(),$(()=>{e.swiping=!1,m({pace:1,emitChange:!0})})};let W;const y=()=>clearTimeout(W),_=()=>{y(),a.autoplay>0&&i.value>1&&(W=setTimeout(()=>{B(),_()},+a.autoplay))},p=(t=+a.initialSwipe)=>{if(!l.value)return;const o=()=>{var n,u;if(!j(l)){const r={width:l.value.offsetWidth,height:l.value.offsetHeight};e.rect=r,e.width=+((n=a.width)!=null?n:r.width),e.height=+((u=a.height)!=null?u:r.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=R(t),w.forEach(r=>{r.setOffset(0)}),_()};j(l)?F().then(o):o()},X=()=>p(e.active);let H;const ne=t=>{!a.touchable||(v.start(t),H=Date.now(),y(),P())},oe=t=>{a.touchable&&e.swiping&&(v.move(t),Y.value&&(!a.loop&&(e.active===0&&s.value>0||e.active===i.value-1&&s.value<0)||(be(t,a.stopPropagation),m({offset:s.value}))))},N=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-H,o=s.value/t;if((Math.abs(o)>.25||Math.abs(s.value)>c.value/2)&&Y.value){const u=a.vertical?v.offsetY.value:v.offsetX.value;let r=0;a.loop?r=u>0?s.value>0?-1:1:0:r=-Math[s.value>0?"ceil":"floor"](s.value/c.value),m({pace:r,emitChange:!0})}else s.value&&m({pace:0});e.swiping=!1,_()},se=(t,o={})=>{P(),v.reset(),$(()=>{let n;a.loop&&t===i.value?n=e.active===0?0:t:n=t%i.value,o.immediate?$(()=>{e.swiping=!1}):e.swiping=!1,m({pace:n-e.active,emitChange:!0})})},ce=(t,o)=>{const n=o===z.value,u=n?{backgroundColor:a.indicatorColor}:void 0;return T("i",{style:u,class:A("indicator",{active:n})},null)},re=()=>{if(h.indicator)return h.indicator({active:z.value,total:i.value});if(a.showIndicators&&i.value>1)return T("div",{class:A("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(ce)])};return Z({prev:ie,next:B,state:e,resize:X,swipeTo:se}),E({size:c,props:a,count:i,activeIndicator:z}),k(()=>a.initialSwipe,t=>p(+t)),k(i,()=>p(e.active)),k(()=>a.autoplay,_),k([ue,de],X),k(fe(),t=>{t==="visible"?_():y()}),q(p),he(()=>p(e.active)),we(()=>p(e.active)),ge(y),me(y),pe("touchmove",oe,{target:f}),()=>{var t;return T("div",{ref:l,class:A()},[T("div",{ref:f,style:te.value,class:A("track",{vertical:a.vertical}),onTouchstartPassive:ne,onTouchend:N,onTouchcancel:N},[(t=h.default)==null?void 0:t.call(h)]),re()])}}});const Pe=J(xe),[ke,Te]=G("swipe-item");var Se=K({name:ke,setup(a,{slots:S}){let h;const l=U({offset:0,inited:!1,mounted:!1}),{parent:f,index:e}=ye(ee);if(!f)return;const v=d(()=>{const i={},{vertical:c}=f.props;return f.size.value&&(i[c?"height":"width"]=`${f.size.value}px`),l.offset&&(i.transform=`translate${c?"Y":"X"}(${l.offset}px)`),i}),w=d(()=>{const{loop:i,lazyRender:c}=f.props;if(!c||h)return!0;if(!l.mounted)return!1;const s=f.activeIndicator.value,g=f.count.value-1,I=s===0&&i?g:s-1,b=s===g&&i?0:s+1;return h=e.value===s||e.value===I||e.value===b,h}),E=i=>{l.offset=i};return q(()=>{F(()=>{l.mounted=!0})}),Z({setOffset:E}),()=>{var i;return T("div",{class:Te(),style:v.value},[w.value?(i=S.default)==null?void 0:i.call(S):null])}}});const Ce=J(Se);export{Pe as S,Ce as a};
