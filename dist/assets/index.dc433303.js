import{c as S,n as s,t as _,X as w,d as E,E as g,y as $,g as B,b as u,$ as j,V as D,N,P as C,G as R,a5 as x,a as n,ad as U,aQ as V,i as k,I as F,w as G}from"./index.178e022e.js";const[M,i]=S("image"),Q={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:s,height:s,radius:s,lazyLoad:Boolean,iconSize:s,showError:_,errorIcon:w("photo-fail"),iconPrefix:String,showLoading:_,loadingIcon:w("photo")};var T=E({name:M,props:Q,emits:["load","error"],setup(e,{emit:m,slots:c}){const l=g(!1),o=g(!0),r=g(),{$Lazyload:t}=$().proxy,I=B(()=>{const a={width:u(e.width),height:u(e.height)};return j(e.radius)&&(a.overflow="hidden",a.borderRadius=u(e.radius)),a});D(()=>e.src,()=>{l.value=!1,o.value=!0});const v=a=>{o.value&&(o.value=!1,m("load",a))},f=a=>{l.value=!0,o.value=!1,m("error",a)},h=(a,d,z)=>z?z():n(F,{name:a,size:e.iconSize,class:d,classPrefix:e.iconPrefix},null),L=()=>{if(o.value&&e.showLoading)return n("div",{class:i("loading")},[h(e.loadingIcon,i("loading-icon"),c.loading)]);if(l.value&&e.showError)return n("div",{class:i("error")},[h(e.errorIcon,i("error-icon"),c.error)])},P=()=>{if(l.value||!e.src)return;const a={alt:e.alt,class:i("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?U(n("img",k({ref:r},a),null),[[V("lazy"),e.src]]):n("img",k({ref:r,src:e.src,onLoad:v,onError:f},a),null)},b=({el:a})=>{const d=()=>{a===r.value&&o.value&&v()};r.value?d():x(d)},y=({el:a})=>{a===r.value&&!l.value&&f()};return t&&N&&(t.$on("loaded",b),t.$on("error",y),C(()=>{t.$off("loaded",b),t.$off("error",y)})),R(()=>{x(()=>{var a;(a=r.value)!=null&&a.complete&&v()})}),()=>{var a;return n("div",{class:i({round:e.round,block:e.block}),style:I.value},[P(),L(),(a=c.default)==null?void 0:a.call(c)])}}});const q=G(T);export{q as I};
